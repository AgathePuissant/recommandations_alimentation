library("stats", lib.loc="C:/Program Files/R/R-3.5.1/library")
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA",  row.names=1)
setwd("~/2018-2019 AgroParisTech_2A/UC à choix/UC Projet - Initiation à la recherche en biologie")
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA",  row.names=1)
head(myData, n=10)
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA",  row.names=1)
head(myData, n=10)
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA",  row.names=1)
head(myData, n=10)
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
summary(myData)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
by(myData$NiveauFactor, myData$Nombre.de.motoneurones, mean)
by(myData$Niveau, myData$Nombre.de.motoneurones, mean)
by(myData$Nombre.de.motoneurones, myData$NiveauFactor,  mean)
by(myData$Nombre.de.motoneurones, myData$Génotype,  mean)
Moyenne.lm(Nombre.de.motoneurone~NiveauFactor+Génotype, data=myData)
Moyenne.lm=lm(Nombre.de.motoneurone~NiveauFactor+Génotype, data=myData)
Moyenne.lm=lm(Nombre.de.motoneurones~NiveauFactor+Génotype, data=myData)
Moyenne.lm=lm(Nombre.de.motoneurones~NiveauFactor+Génotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
library(car)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
library(lsmeans)
library(lsmean)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
install.packages("lsmeans")
library(lsmean)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
library(lsmean)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~NiveauFactor, adjust="bonferroni")
boxplot(myData$Nombre.de.motoneurones~myData$Génotype*myData$NiveauFactor, ylab="Nombre de motoneurones")
par(mfrow=c(1,1))
boxplot(myData$Nombre.de.motoneurones~myData$Génotype*myData$NiveauFactor, ylab="Nombre de motoneurones")
barplot(myData$Nombre.de.motoneurones~myData$Génotype*myData$NiveauFactor, ylab="Nombre de motoneurones")
interaction.plot(myData$Génotype, myData$NiveauFactor, myData$Nombre.de.motoneurones, fixed=TRUE)
Moyenne2.lm=lm(Nombre.de.motoneurones~NiveauFactor*Génotype, data=myData)
summary(Moyenne2.lm)
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~Génotype, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~Génotype+NiveauFactor, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~Génotype*NiveauFactor, adjust="bonferroni")
myData=read.table(file="analyse_sorties.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
#by(myData$Nombre.de.motoneurones, myData$NiveauFactor,  mean)
#by(myData$Nombre.de.motoneurones, myData$Génotype,  mean)
library(car)
library(lsmeans)
myData=read.table(file="analyse_sorties.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
summary(myData)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
myData$TotalSorties=myData$Substance.grise+myData$Hors.moelle
summary(myData)
boxplot(myData$TotalSorties~myData$Génotype*myData$NiveauFactor, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Genotype*myData$NiveauFactor, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Embryon*myData$NiveauFactor, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Embryon*myData$Genotype, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Embryon, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Genotype, ylab="Nombre de motoneurones")
myData=read.table(file="analyse_sorties.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
library(car)
library(lsmeans)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
#by(myData$Nombre.de.motoneurones, myData$NiveauFactor,  mean)
#by(myData$Nombre.de.motoneurones, myData$Génotype,  mean)$
myData$TotalSorties=myData$Substance.grise+myData$Hors.moelle
boxplot(myData$TotalSorties~myData$Embryon, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Genotype, ylab="Nombre de motoneurones")
Moyenne.lm=lm(TotalSortiess~NiveauFactor+Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Génotype+NiveauFactor, adjust="bonferroni")
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype+NiveauFactor, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~Genotype+NiveauFactor, adjust="bonferroni")
Moyenne.lm=lm(TotalSortiess~NiveauFactor+Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Moyenne.lm=lm(TotalSortiess~Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Moyenne.lm=lm(TotalSorties~Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype+NiveauFactor, adjust="bonferroni")
myData=read.table(file="analyse_sorties.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
library(car)
library(lsmeans)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
#by(myData$Nombre.de.motoneurones, myData$NiveauFactor,  mean)
#by(myData$Nombre.de.motoneurones, myData$Génotype,  mean)$
myData$TotalSorties=myData$Substance.grise+myData$Hors.moelle
boxplot(myData$TotalSorties~myData$Embryon, ylab="Nombre de motoneurones")
boxplot(myData$TotalSorties~myData$Genotype, ylab="Nombre de motoneurones")
Moyenne.lm=lm(TotalSorties~Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype+NiveauFactor, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~Genotype+NiveauFactor, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
Moyenne.lm=lm(TotalSorties~Embryon, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
Moyenne.lm=lm(TotalSorties~Embryon, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
Anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
anova(Moyenne.lm)
summary(Moyenne.lm)
Moyenne.lm=lm(TotalSorties~Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
barplot(myData$TotalSorties~myData$Embryon, ylab="Nombre de motoneurones")
barplot(myData$TotalSorties~myData$Genotype, ylab="Nombre de motoneurones")
barplot(myData$TotalSorties,myData$Embryon, ylab="Nombre de motoneurones")
barplot(myData$TotalSorties,myData$Genotype, ylab="Nombre de motoneurones")
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~Génotype+NiveauFactor, adjust="bonferroni")
myData=read.table(file="analyse_comptages.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
myData$NiveauFactor<-as.factor(myData$Niveau)
summary(myData)
by(myData$Nombre.de.motoneurones, myData$NiveauFactor,  mean)
by(myData$Nombre.de.motoneurones, myData$Génotype,  mean)
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~Génotype+NiveauFactor, adjust="bonferroni")
Moyenne.lm=lm(Nombre.de.motoneurones~NiveauFactor+Génotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
library(lsmeans)
lsmeans(Moyenne.lm, pairwise~Génotype+NiveauFactor, adjust="bonferroni")
setwd("~/")
myData=read.table(file="comptages_marie.csv", sep=";", skip=0, header=T,na.strings="NA")
head(myData, n=10)
library(car)
library(lsmeans)
summary(myData)
boxplot(myData$TotalSorties~myData$Embryon)
boxplot(myData$TotalSorties~myData$Genotype)
boxplot(myData$Total~myData$Embryon)
boxplot(myData$Total~myData$Genotype)
Moyenne.lm=lm(ZV~Marquage, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
lsmeans(Moyenne.lm, pairwise~myData$Genotype, adjust="bonferroni")
Moyenne.lm=lm(ZV~Marquage+Genotype, data=myData)
par(mfrow=c(2,2))
plot(Moyenne.lm)
summary(Moyenne.lm)
anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype, adjust="bonferroni")
anova(Moyenne.lm)
lsmeans(Moyenne.lm, pairwise~Genotype+Marquage, adjust="bonferroni")
boxplot(myData$ZV~myData$Embryon)
boxplot(myData$ZV~myData$Genotype)
boxplot(myData$ZSV~myData$Embryon)
boxplot(myData$ZSV~myData$Genotype)
boxplot(myData$M~myData$Embryon)
boxplot(myData$M~myData$Genotype)
summary(myData)
boxplot(myData$ZV~myData$Embryon, title="ZV")
boxplot(myData$ZV~myData$Genotype, title="ZV")
boxplot(myData$ZSV~myData$Embryon, title="ZSV")
boxplot(myData$ZSV~myData$Genotype, title="ZSV")
boxplot(myData$M~myData$Embryon, title="M")
boxplot(myData$M~myData$Genotype, title="M")
setwd("C:/Users/lili-/Desktop/PROJET_FIL_ROUGE/clusters_consommateurs")
bilan = read.csv("table_analyse_3.csv", sep = ",",header=T)
library(dplyr)
library(cluster)
library(fpc)
library("ggplot2")
library("reshape2")
library("purrr")
library("dplyr")# let's start with a dendrogram
library("dendextend")
bilan$sexeps<- as.factor(bilan$sexeps)
bilan$tage<- as.factor(bilan$tage)
bilan$bmi<- as.factor(bilan$bmi)
bilan$fromages<- as.factor(bilan$fromages)
bilan$fruits<- as.factor(bilan$fruits)
bilan$lÃ.gumes..hors.pommes.de.terre.<- as.factor(bilan$lÃ.gumes..hors.pommes.de.terre.)
bilan$poissons<- as.factor(bilan$poissons)
bilan$ultra.frais.laitier<- as.factor(bilan$ultra.frais.laitier)
bilan$viande<- as.factor(bilan$viande)
bilan$volaille.et.gibier<- as.factor(bilan$volaille.et.gibier)
gower.dist <- daisy(bilan[ ,2:11], metric = c("gower"))
aggl.clust.c <- hclust(gower.dist, method = "complete")
cstats.table <- function(dist, tree, k) {
clust.assess <- c("cluster.number","n","within.cluster.ss","average.within","average.between",
"wb.ratio","dunn2","avg.silwidth")
clust.size <- c("cluster.size")
stats.names <- c()
row.clust <- c()
output.stats <- matrix(ncol = k, nrow = length(clust.assess))
cluster.sizes <- matrix(ncol = k, nrow = k)
for(i in c(1:k)){
row.clust[i] <- paste("Cluster-", i, " size")
}
for(i in c(2:k)){
stats.names[i] <- paste("Test", i-1)
for(j in seq_along(clust.assess)){
output.stats[j, i] <- unlist(cluster.stats(d = dist, clustering = cutree(tree, k = i))[clust.assess])[j]
}
for(d in 1:k) {
cluster.sizes[d, i] <- unlist(cluster.stats(d = dist, clustering = cutree(tree, k = i))[clust.size])[d]
dim(cluster.sizes[d, i]) <- c(length(cluster.sizes[i]), 1)
cluster.sizes[d, i]
}
}
output.stats.df <- data.frame(output.stats)
cluster.sizes <- data.frame(cluster.sizes)
cluster.sizes[is.na(cluster.sizes)] <- 0
rows.all <- c(clust.assess, row.clust)
# rownames(output.stats.df) <- clust.assess
output <- rbind(output.stats.df, cluster.sizes)[ ,-1]
colnames(output) <- stats.names[2:k]
rownames(output) <- rows.all
is.num <- sapply(output, is.numeric)
output[is.num] <- lapply(output[is.num], round, 2)
output
}
ggplot(data = data.frame(t(cstats.table(gower.dist, aggl.clust.c, 12))),
aes(x=cluster.number, y=within.cluster.ss)) +
geom_point()+
geom_line()+
ggtitle("Agglomerative clustering") +
labs(x = "Num.of clusters", y = "Within clusters sum of squares (SS)") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = data.frame(t(cstats.table(gower.dist, aggl.clust.c, 12))),
aes(x=cluster.number, y=avg.silwidth)) +
geom_point()+
geom_line()+
ggtitle("Agglomerative clustering") +
labs(x = "Num.of clusters", y = "Average silhouette width") +
theme(plot.title = element_text(hjust = 0.5))
dendro.col <- dendro %>%
set("branches_k_color", k = 5, value = c("darkslategray3", "gold3", "darkslategray4", "cyan3", "gold3")) %>%
set("branches_lwd", 0.6) %>%
set("labels_colors", value = c("darkslategray")) %>%
set("labels_cex", 0.5)
dendro.col <- dendro %>%
set("branches_k_color", k = 5, value = c("darkslategray3", "gold3", "darkslategray4", "cyan3", "gold3")) %>%
set("branches_lwd", 0.6) %>%
set("labels_colors", value = c("darkslategray")) %>%
set("labels_cex", 0.5)
library("dendextend")
library("dplyr")# let's start with a dendrogram
dendro.col <- dendro %>%
set("branches_k_color", k = 5, value = c("darkslategray3", "gold3", "darkslategray4", "cyan3", "gold3")) %>%
set("branches_lwd", 0.6) %>%
set("labels_colors", value = c("darkslategray")) %>%
set("labels_cex", 0.5)
dendro <- as.dendrogram(aggl.clust.c)
dendro.col <- dendro %>%
set("branches_k_color", k = 5, value = c("darkslategray3", "gold3", "darkslategray4", "cyan3", "gold3")) %>%
set("branches_lwd", 0.6) %>%
set("labels_colors", value = c("darkslategray")) %>%
set("labels_cex", 0.5)
ggd1 <- as.ggdend(dendro.col)
ggplot(ggd1, theme = theme_minimal()) +
labs(x = "Num. observations", y = "Height", title = "Dendrogram, k = 8")
ggplot(ggd1, theme = theme_minimal()) +
labs(x = "Num. observations", y = "Height", title = "Dendrogram, k = 5")
ggd1 <- as.ggdend(dendro.col)
clust.num <- cutree(aggl.clust.c, k = 5)
bilan.cl <- cbind(bilan, clust.num)
write.table(bilan.cl, "clusters_enf.csv", sep = ";", row.names = TRUE)
dendro <- as.dendrogram(aggl.clust.c)
dendro.col <- dendro %>%
set("branches_k_color", k = 10, value = c("darkslategray3", "gold3", "darkslategray4", "cyan3", "gold3", "darkslategray", "darkslategray4", "gold3",  "darkslategray4", "cyan3")) %>%
set("branches_lwd", 0.6) %>%
set("labels_colors", value = c("darkslategray")) %>%
set("labels_cex", 0.5)
ggd1 <- as.ggdend(dendro.col)
ggplot(ggd1, theme = theme_minimal()) +
labs(x = "Num. observations", y = "Height", title = "Dendrogram, k = 10")
clust.num <- cutree(aggl.clust.c, k = 10)
bilan.cl <- cbind(bilan, clust.num)
write.table(bilan.cl, "clusters_enf.csv", sep = ";", row.names = TRUE)
